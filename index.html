<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Visualisation des projets de l'Agence Française de Développement (AFD)">
  <title>Infographic – Projets AFD</title>
  
  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  
  <!-- Animation Libraries - Make sure AOS is loaded before script.js -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  
  <!-- Custom styles -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Navigation Bar -->
  <div class="nav-container" id="navbar">
    <div class="navbar">
      <a href="#" class="logo">
        <i class="fas fa-chart-pie"></i> AIFR.AI AFD
      </a>
      
      <ul class="nav-links">
        <li><a href="#stats" class="active">Stats</a></li>
        <li><a href="#extra-stats">Stats Avancées</a></li>
        <li><a href="#charts">Graphiques</a></li>
        <li><a href="#regions">Régions</a></li>
        <li><a href="#sectors">Secteurs</a></li>
        <li><a href="#timeline">Chronologie</a></li>
        <li><a href="#table">Données</a></li>
      </ul>
      
      <div class="burger">
        <div></div>
        <div></div>
        <div></div>
      </div>
    </div>
  </div>
  
  <!-- Hero Section -->
  <section class="hero" id="home">
    <div class="hero-content">
      <h1 class="hero-title">Infographic – Projets AFD</h1>
      <p class="hero-subtitle">Analyse approfondie des projets : financements, dates, localisations et impact économique. Données sourcées depuis data.gouv.fr.</p>
    </div>
        
    <a href="#stats" class="scroll-down">
      <i class="fas fa-chevron-down"></i>
    </a>
    
    <div class="wave"></div>
  </section>

  <div id="loading" class="loading"> <!-- Default to visible, script will hide -->
    <div class="loader"><div></div><div></div><div></div><div></div></div>
    <p>Chargement et traitement des données en cours...</p>
    <p><small>Source: data.gouv.fr</small></p>
  </div>

  <div class="dashboard" id="dashboard-content" style="display:none;">
    <!-- Basic Stats Section -->
    <section id="stats" class="stats-container">
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="100">
        <h3><i class="fas fa-euro-sign"></i> Budget Total</h3>
        <div id="totalBudget" class="stat-value"></div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="200">
        <h3><i class="fas fa-tasks"></i> Nombre de Projets</h3>
        <div id="projectCount" class="stat-value"></div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="300">
        <h3><i class="fas fa-chart-line"></i> Budget Moyen</h3>
        <div id="avgBudget" class="stat-value"></div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="400">
        <h3><i class="fas fa-globe-europe"></i> Pays Couverts</h3>
        <div id="countryCount" class="stat-value"></div>
      </div>
    </section>

    <!-- Extra Stats Section -->
    <section id="extra-stats">
      <h3 style="text-align:center; margin-bottom:20px; font-size:1.8rem; color:var(--primary-color);">Statistiques Avancées</h3>
      <div class="extra-stats-container">
        <div class="mini-stat" data-aos="fade-up" data-aos-delay="100">
          <div class="icon"><i class="fas fa-hourglass-half"></i></div>
          <div id="projectsInExecution" class="value"></div>
          <div class="label">Projets en Exécution</div>
        </div>
        <div class="mini-stat" data-aos="fade-up" data-aos-delay="150">
          <div class="icon"><i class="fas fa-check-circle"></i></div>
          <div id="projectsCompleted" class="value"></div>
          <div class="label">Projets Achevés</div>
        </div>
        <div class="mini-stat" data-aos="fade-up" data-aos-delay="200">
          <div class="icon"><i class="fas fa-handshake"></i></div>
          <div id="cofinancedProjects" class="value"></div>
          <div class="label">Projets Cofinancés</div>
        </div>
        <div class="mini-stat" data-aos="fade-up" data-aos-delay="250">
          <div class="icon"><i class="fas fa-calendar-alt"></i></div>
          <div id="avgProjectDuration" class="value"></div>
          <div class="label">Durée Moyenne (années)</div>
        </div>
        <div class="mini-stat" data-aos="fade-up" data-aos-delay="300">
          <div class="icon"><i class="fas fa-building"></i></div>
          <div id="publicEntities" class="value"></div>
          <div class="label">Entités Publiques</div>
        </div>
        <div class="mini-stat" data-aos="fade-up" data-aos-delay="350">
          <div class="icon"><i class="fas fa-users"></i></div>
          <div id="privateEntities" class="value"></div>
          <div class="label">Entités Privées</div>
        </div>
      </div>
    </section>

    <!-- Charts Section -->
    <section id="charts">
      <h3 style="text-align:center; margin-bottom:20px; font-size:1.8rem; color:var(--primary-color);">Graphiques</h3>
      <div class="chart-grid">
        <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
          <h3>Top 10 des Projets par Budget</h3>
          <div class="chart-wrapper">
            <canvas id="barChart"></canvas>
          </div>
        </div>
        <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
          <h3>Répartition des Projets par État</h3>
          <div class="chart-wrapper">
            <canvas id="pieChart"></canvas>
          </div>
        </div>
      </div>
      <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
        <h3>Évolution des Projets par Année</h3>
        <div class="chart-wrapper">
          <canvas id="lineChart"></canvas>
        </div>
      </div>
    </section>

    <section id="regions">
      <h3 style="text-align:center; margin-bottom:20px; font-size:1.8rem; color:var(--primary-color);">Répartition par Région</h3>
      <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
        <div class="chart-wrapper">
          <canvas id="regionChart"></canvas>
        </div>
      </div>
    </section>

    <section id="sectors">
      <h3 style="text-align:center; margin-bottom:20px; font-size:1.8rem; color:var(--primary-color);">Répartition par Secteur</h3>
      <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
        <div class="chart-wrapper">
          <canvas id="sectorChart"></canvas>
        </div>
      </div>
    </section>

    <section id="timeline">
      <h3 style="text-align:center; margin-bottom:20px; font-size:1.8rem; color:var(--primary-color);">Chronologie des Projets</h3>
      <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
        <div class="chart-wrapper">
          <canvas id="timelineChart"></canvas>
        </div>
      </div>
    </section>

    <section id="table" class="table-container" data-aos="fade-up" data-aos-duration="1000">
      <div class="filters-container">
        <div class="search-container">
          <input type="text" id="searchInput" class="search-input" placeholder="Rechercher par titre, pays, secteur...">
          <select id="sortField">
            <option value="budget-desc" selected>Budget (décroissant)</option>
            <option value="budget-asc">Budget (croissant)</option>
            <option value="title-asc">Titre A-Z</option>
            <option value="title-desc">Titre Z-A</option>
            <option value="date-desc">Date d'octroi (récent)</option>
            <option value="date-asc">Date d'octroi (ancien)</option>
          </select>
        </div>
        <select id="stateFilter">
          <option value="all">Tous les états</option>
        </select>
        <select id="countryFilter">
          <option value="all">Tous les pays</option>
        </select>
        <select id="sectorFilter">
          <option value="all">Tous les secteurs</option>
        </select>
      </div>

      <div class="active-filters">
        <span style="margin-right:10px;font-weight:bold; display:none;">Filtres actifs:</span>
        <div id="active-filter-pills"></div>
      </div>
      
      <!-- Sort Metrics (div id="sort-metrics") will be inserted here by script.js -->
      <!-- Filter Metrics (div id="filter-metrics") will be inserted here by script.js -->
      <div id="filter-metrics" class="filter-metrics" style="display:none;"></div>

      <div class="table-responsive">
        <table id="dataTable">
          <thead>
            <tr>
              <th style="width: 60px;">Détails</th>
              <th>Titre du projet</th>
              <th style="width: 120px;">Budget</th> <!-- Increased width for M€ -->
              <th style="width: 150px;">État</th> <!-- Increased width for longer status text -->
              <th style="width: 120px;">Pays</th>
              <th>Secteur</th>
              <th style="width: 120px;">Date d'octroi</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div id="table-footer-metrics" class="footer-metrics" style="display:none;"></div>

      <div class="pagination">
        <button id="prevPage" disabled>« Précédent</button>
        <button id="nextPage">Suivant »</button>
      </div>
      <div class="page-info">
        Affichage de <span id="startIndex">0</span> à <span id="endIndex">0</span> sur <span id="totalItems">0</span> projets
      </div>
    </section>

    <section id="budget-country">
      <h3 style="text-align:center; margin-bottom:20px; font-size:1.8rem; color:var(--primary-color);">Budget par Pays</h3>
      <div class="table-container" data-aos="fade-up" data-aos-duration="1000">
        <div class="table-responsive">
          <table id="budgetByCountryTable">
            <thead>
              <tr>
                <th>Pays</th>
                <th>Budget Total (M€)</th>
                <th>Nombre de Projets</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
  </div>
  
  <!-- Custom script -->
  <script src="script.js"></script>
</body>
</html>